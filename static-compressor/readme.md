## TraceZip Algorithm Validate

This repository is used to show the structure behind spans.

For now, it is deliberatly designed to compress `alibaba-cluster-trace-data-v2022/CallGraph` data, but you can modify it and make it is able to compress any kind of spans data which is represented as CSV file.

Even though the redundancy of the spans data in `alibaba-cluster-trace-data-v2022/CallGraph` is lower compared to the spans generated by OpenTelemetry, we found that static compression using TraceZip still yields good results. During static compression, we considered the internal redundancy of the strings within the `alibaba-cluster-trace-data-v2022/CallGraph` spans, and the large buffer size of TraceZip helps it identify global redundant strings.

We noticed that in the Alibaba dataset, some of the span data formats do not match the CSV format (specifically, certain rows have fewer or more attribute values than the number specified in the header). We have directly ignored these rows. The number of such rows is very small.

To Compress spans, running it by `go run . -path <file_path> -dirname <output_dir_name> -chunk <chunk_size> -j <core_num> -merging`

To Decompress spans, running it by `go run . -dirname <input_dir_name> -decompress`

This program supports several command-line flags to configure its behavior. Below is a detailed explanation of each flag:

| **Flag**   | **Type** | **Default Value** | **Description**                                                                                 |
| ---------------- | -------------- | ----------------------- | ----------------------------------------------------------------------------------------------------- |
| `-path`        | `string`     | `""`                  | Specifies the path of the file to be compressed. This is a required parameter for compression.        |
| `-chunk`       | `int`        | `0`                   | Sets the chunk size for processing the data. If set to `0`, the entire file is processed in one go. |
| `-j`           | `int`        | `1`                   | Sets the maximum number of CPU cores to be used during execution                                      |
| `-merging`     | `bool`       | `false`               | Enables Merging Tree compression. If set to `true`, the program will use Merging Tree compression.  |
| `-decompress`  | `bool`       | `false`               | Specifies whether the program should decompress files instead of compressing them. Configure it with `-dirname` simultaneously.                  |
| `-dirname`     | `string`     | `"output"`            | Specifies the name of the output directory where compressed files will be stored.                     |
| `-not_alibaba` | `bool`       | `false`               | Determines the sorting order of attributes:                                                           |
|                |            |                         | - If `true`, attributes are sorted by their optional value counts in ascending order.               |
|                |            |                         | - If `false`, attributes are sorted based on a predefined order.                                    |
