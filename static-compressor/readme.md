## TraceZip Algorithm Validate

This repository is used to show the structure behind spans.

For now, it is deliberatly designed to compress `alibaba-cluster-trace-data-v2022/CallGraph` data, but you can modify it and make it is able to compress any kind of spans data which is represented as CSV file.

Even though the redundancy of the spans data in `alibaba-cluster-trace-data-v2022/CallGraph` is lower compared to the spans generated by OpenTelemetry, we found that static compression using TraceZip still yields good results. During static compression, we considered the internal redundancy of the strings within the `alibaba-cluster-trace-data-v2022/CallGraph` spans, and the large buffer size of TraceZip helps it identify global redundant strings.

We noticed that in the Alibaba dataset, some of the span data formats do not match the CSV format (specifically, certain rows have fewer or more attribute values than the number specified in the header). We have directly ignored these rows. The number of such rows is very small.

To Compress spans, running it by `go run . -path <file_path> -dirname <output_dir_name> -chunk <chunk_size> -j <core_num> -merging`

To Decompress spans, running it by `go run . -dirname <input_dir_name> -decompress`

This program supports several command-line flags to configure its behavior. Below is a detailed explanation of each flag:

| **Flag**        | **Type**   | **Default**  | **Description**                                                                 |
|----------------|-----------|-------------|-----------------------------------------------------------------------------|
| `-path`       | `string`  | `""`        | Path of the file to be compressed (**Required for compression**).          |
| `-chunk`      | `int`     | `0`         | Chunk size for processing data (`0` means processing the entire file at once). |
| `-j`          | `int`     | `1`         | Number of CPU cores to use.                                                 |
| `-merging`    | `bool`    | `false`     | Enables Merging Tree compression (`true` enables it).                       |
| `-decompress` | `bool`    | `false`     | Enables decompression mode (**Used with `-dirname`**).                      |
| `-dirname`    | `string`  | `"output"`  | Directory name for storing compressed files (used for both compression and decompression). |
| `-not_alibaba`| `bool`    | `false`     | Attribute sorting mode:                                                      |
|               |           |             | - `true`: Sorts attributes by optional value counts (ascending order).      |
|               |           |             | - `false`: Uses a predefined attribute order.                               |